<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="logo.jpg">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src='https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.1/tabletop.min.js'></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.min.js"></script>
</head>



<body>

    <div id="title">Archie Webster</div>



    <div id="butns">
        <button class="button" onclick="window.location.href = 'https://flickr.com/artomweb';">Flickr</button>
        <button class="button" onclick="window.location.href = 'https://github.com/artomweb';">Github</button>
        <button class="button" onclick="window.location.href = 'https://www.thingiverse.com/artomweb2/designs';">Thingiverse</button>
        <button class="button" onclick="window.location.href = 'Projects/Projects 664c3dc51d8c4588becb0db505f9d0cb.html';">Projects</button>

    </div>

    <div class="row">
        <div class="column">
            <div class="subHeadings">
                How have I slept recently :)
            </div>

            <canvas id="sleep" class="imageContainer"></canvas>
        </div>

        <div class="column">
            <div class="subHeadings">
                How many steps have I done
            </div>

            <canvas id="steps" class="imageContainer" width='300'></canvas>
        </div>

    </div>


    <script type="text/javascript">
        function shuffle(a) {
            var j, x, i;
            for (i = a.length - 1; i > 0; i--) {
                j = Math.floor(Math.random() * (i + 1));
                x = a[i];
                a[i] = a[j];
                a[j] = x;
            }
            return a;
        }

        colors = ['#62bdc7', '#d8a0a1', '#657786', '#c37777']
        shuffle(colors)
        var butns = document.getElementById("butns").children;
        var i, e;
        for (i = 0; i < butns.length; i++) {
            e = butns[i];
            e.style.backgroundColor = colors[i];
        }




        var sleepSheet = 'https://docs.google.com/spreadsheets/d/1TqN1Lsj9MxGrfsVrmywdFkLdW3zbqU75zjyslvIRHNM/edit?usp=sharing';

        function init() {
            Tabletop.init({
                key: sleepSheet,
                callback: showInfo,
                simpleSheet: true
            })
        }

        function showInfo(data, tabletop) {
            showSleepGraph(data);
        }

        window.addEventListener('DOMContentLoaded', init)

        function secondsToMins(e) {
            return new Date(1000 * e).toISOString().substr(11, 5)
        }


        function showSleepGraph(allData) {
            allData.sort(function(a, b) {
                return new Date(a.Date).getTime() - new Date(b.Date).getTime();
            });

            console.log(allData);
            var labels = allData.map(function(e) {
                return new Date(e.Date);
            });

            var data = allData.map(function(e) {
                return e.Duration;
            });

            var ctx = document.getElementById('sleep').getContext('2d');
            console.log(data);
            var myChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{

                        tension: 0.3,
                        data: data,
                        backgroundColor: colors[0]
                    }]
                },

                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    legend: {
                        display: false
                    },
                    scales: {
                        xAxes: [{
                            type: 'time',
                            time: {
                                unit: "day",
                                round: "day",
                                displayFormats: {
                                    day: "MMM D"
                                }
                            }

                        }],
                        yAxes: [{
                            ticks: {
                                callback: function(value, index, values) {
                                    return secondsToMins(value)
                                }
                            }
                        }]

                    },

                    tooltips: {
                        callbacks: {
                            label: function(tooltipItem, data) {
                                var label = data.datasets[tooltipItem.datasetIndex].label || '';

                                if (label) {
                                    label += ': ';
                                }

                                label += secondsToMins(tooltipItem.yLabel);
                                return label;

                            }

                        }
                    }
                }
            });
        }






        var stepsSheet = 'https://docs.google.com/spreadsheets/d/15PbAyFyxjhlkCjpsk-VR2v1KsRIQCydOISzUBg88O9o/edit?usp=sharing';

        function init2() {
            Tabletop.init({
                key: stepsSheet,
                callback: showInfo2,
                simpleSheet: true
            })
        }

        function showInfo2(data, tabletop) {
            showStepsGraph(data);
        }

        window.addEventListener('DOMContentLoaded', init2)

        function secondsToMins(e) {
            return new Date(1000 * e).toISOString().substr(11, 5)
        }


        function showStepsGraph(allData) {

            allData.sort(function(a, b) {
                return new Date(a.Date).getTime() - new Date(b.Date).getTime();
            });

            console.log(allData);
            var labels = allData.map(function(e) {
                return new Date(e.Date);
            });

            var data = allData.map(function(e) {
                return e.Steps;
            });

            var ctx2 = document.getElementById('steps').getContext('2d');
            console.log(data);
            var myChart = new Chart(ctx2, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        tension: 0.3,

                        data: data,
                        backgroundColor: colors[3]
                    }]
                },

                options: {
                    maintainAspectRatio: true,
                    responsive: true,

                    legend: {
                        display: false
                    },
                    scales: {
                        xAxes: [{
                            type: 'time',
                            time: {
                                unit: "day",
                                round: "day",
                                displayFormats: {
                                    day: "MMM D"
                                }
                            }

                        }]


                    }
                }
            });
        }
    </script>

</body>

</html>