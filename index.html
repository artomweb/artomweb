<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="logo.jpg">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src='https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.1/tabletop.min.js'></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.min.js"></script>
</head>



<body>

    <div id="title">
        Archie Webster
    </div>



    <div id="butns">
        <button class="button" onclick="window.location.href = 'https://flickr.com/artomweb';">Flickr</button>
        <button class="button" onclick="window.location.href = 'https://github.com/artomweb';">Github</button>
        <button class="button" onclick="window.location.href = 'https://www.thingiverse.com/artomweb2/designs';">Thingiverse</button>
        <button class="button" onclick="window.location.href = 'Projects/Projects 664c3dc51d8c4588becb0db505f9d0cb.html';">Projects</button>

    </div>

    <canvas id="myChart" width="400" height="400"></canvas>


    <script type="text/javascript">
        function shuffle(a) {
            var j, x, i;
            for (i = a.length - 1; i > 0; i--) {
                j = Math.floor(Math.random() * (i + 1));
                x = a[i];
                a[i] = a[j];
                a[j] = x;
            }
            return a;
        }

        colors = ['#62bdc7', '#d8a0a1', '#657786', '#c37777']
        shuffle(colors)
        var butns = document.getElementById("butns").children;
        var i, e;
        for (i = 0; i < butns.length; i++) {
            e = butns[i];
            e.style.backgroundColor = colors[i];
        }


        var publicSpreadsheetUrl = 'https://docs.google.com/spreadsheets/d/1TqN1Lsj9MxGrfsVrmywdFkLdW3zbqU75zjyslvIRHNM/edit?usp=sharing';

        function init() {
            Tabletop.init({
                key: publicSpreadsheetUrl,
                callback: showInfo,
                simpleSheet: true
            })
        }

        function showInfo(data, tabletop) {
            showGraph(data);
        }

        window.addEventListener('DOMContentLoaded', init)

        function secondsToMins(e) {
            return new Date(1000 * e).toISOString().substr(11, 5)
        }


        function showGraph(allData) {
            console.log(allData);
            var labels = allData.map(function(e) {
                return new Date(e.Date);
            });

            var data = allData.map(function(e) {
                var splits = e.Duration.split(':')
                var hours = splits[0];
                var minutes = splits[1];

                var seconds = (hours * 3600) + (minutes * 60);

                return seconds;
            });

            var dataTicks = allData.map(function(e) {
                return e.Duration;
            })

            var ctx = document.getElementById('myChart').getContext('2d');
            console.log(data);
            var myChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Sleep',
                        data: data,
                        backgroundColor: "rgba(153,255,51,0.6)"
                    }]
                },

                options: {
                    scales: {
                        xAxes: [{
                            type: 'time'
                        }],
                        yAxes: [{
                            ticks: {
                                callback: function(value, index, values) {
                                    return secondsToMins(value)
                                }
                            }
                        }]

                    }
                }
            });

        }
    </script>

</body>

</html>